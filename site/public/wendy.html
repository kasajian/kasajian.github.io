<!DOCTYPE html>
<html>  <head><title>Wendy Function Creator</title></head>
<body>
<h3>Wendy Function Creator</h3>
Type your name: <input type="text" id="userName" value="Wendy"><p><p/>

<p id="demo"></p>

<button onclick="onClick()">Create</button><p><p/>
<div id="out" hidden>
<p>Result:</p><textarea id="result" rows="16" cols="60"></textarea><p><p/>
Try it at repl.it: <a href="https://repl.it/languages/basic"  target="_blank">https://repl.it/languages/basic</a>
</div>

<script>
function wendy(userName) {
  var everything = 42;
  var me_and = 23;
  var x, result = '';
  result += `EVERYTHING = ${everything}\n`;
  result += `E = EXP(1)\n`;
  result += `T = ""\n`;
  result += `FOR I = 0 TO ${userName.length}\n`;
  var a = [];
  for (var i = 0; i < userName.length; i++) {
    var d = userName[i].charCodeAt() - 65;
    a.push({d, s: `INT(${x(i)} = I) * ${d} + `});
  }
  a.sort(function(x, y) { return x.d - y.d; } ); 
  var u = '';
  for (var i = 0; i < a.length; i++) {
    u += `${a[i].s}`;
  }
  result += `  T = T + CHR(${me_and} + ${u.substr(0, u.length - 2)} + EVERYTHING)\n`;
  result += `NEXT I\n`;
  result += `PRINT T\n`;
  return result;
  function x(z) {
    var h = [1,-4,-3,-3,-5,8,-2,9,3,-6,-6,4,2,0,-9,3];
    w=function(v){return [7,5,8,12,0,11,15,6,2,13,4,10,3,1,14,9][v];}
    k = [5,9][w(z)%2]-h[w(z)];
    return ["SQR((17 + COS(PI)))",13,8,12,10,"-COS(PI)",7,0,"1 + LOG(E)","3 + COS(PI) + 13",11,5,"(2 + SIN(PI / 2))",9,14,6][w(k)];}
}

function onClick() {
  try {
     var x = ``;
    console.error("no error");
  } catch (error) {
    console.error(error);
    // expected output: ReferenceError: nonExistentFunction is not defined
    // Note - error messages will vary depending on browser
  }
  var userName = document.getElementById("userName").value;
  var result = wendy(userName.substr(0,16).toUpperCase());
  document.getElementById("result").innerHTML = result;
  document.getElementById("out").hidden = false; 
}
</script>
  </body>
</html>
